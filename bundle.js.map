{"version":3,"sources":["webpack:///webpack/bootstrap c4b4d723c7abc4b75cc4","webpack:///./lib/run_script.js","webpack:///./lib/game.js","webpack:///./lib/player.js","webpack:///./lib/color.js","webpack:///./lib/listener.js","webpack:///./lib/canvas.js","webpack:///./lib/scape.js","webpack:///./lib/mass.js","webpack:///./lib/point.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;;AAEA;;;;;;;ACFA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;AC5CA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,mFAAkF;AAClF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;;;;;;AC7KA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAQ;AACR,OAAM;AACN;AACA;AACA;AACA,SAAQ;AACR;;AAEA;AACA;;AAEA;AACA,wBAAuB,OAAO,IAAI,OAAO,KAAK,EAAE;AAChD;AACA;;AAEA;AACA,wBAAuB,mBAAmB,IAAI,OAAO,KAAK,OAAO;AACjE;AACA;;AAEA;AACA,wBAAuB,OAAO,IAAI,OAAO,KAAK,OAAO;AACrD;AACA;;AAEA;;;;;;;ACzCA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;;;;;AC7BA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;;;;;;;ACtBA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB,gCAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;AClDA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qDAAoD,0BAA0B;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,oCAAmC;AACnC,oCAAmC;;AAEnC;AACA;;AAEA;AACA;AACA;;AAEA;;;;;;;AC7DA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap c4b4d723c7abc4b75cc4\n **/","const Game = require('./game');\n\ndocument.addEventListener(\"DOMContentLoaded\", Game.init);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/run_script.js\n ** module id = 0\n ** module chunks = 0\n **/","const Player = require('./player');\nconst Canvas = require('./canvas');\nconst Scape = require('./scape');\nconst Color = require('./color');\n\n// global singleton canvas, or too dangerous?\n\nfunction Game(){\n  this.canvas = new Canvas;\n  this.scapes = [];\n  for(let i = 0; i < 1; i++){\n    const scape = new Scape(this.canvas, i);\n    this.scapes.push(scape);\n  }\n  this.player = new Player(this.scapes);\n}\n\nGame.init = function(){\n  const game = new Game;\n  game.run();\n};\n\nGame.prototype.render = function(){\n  this.canvas.render();\n  this.scapes.forEach( scape => {\n    scape.render();\n  });\n  this.player.render(this.canvas.ctx);\n};\n\nGame.prototype.move = function () {\n  this.scapes.forEach( scape => {\n    scape.move();\n  });\n  this.player.move();\n};\n\nGame.prototype.run = function(td){\n  Color.step();\n  this.move();\n  this.render();\n  window.requestAnimationFrame(td => this.run(td));\n};\n\nmodule.exports = Game;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/game.js\n ** module id = 1\n ** module chunks = 0\n **/","const Color = require('./color');\nconst Listener = require('./listener');\n\nfunction Player(scapes){\n  this.scapes = scapes;\n  this.state = 0;\n\n  this.maxSpeed = 5;\n  this.speed = 0;\n\n  this.radius = 20;\n  this.angle = 0;\n  this.x = 300;\n  this.y = 200;\n\n  this.grounded = true;\n  this.fallSpeed = 0;\n  this.fallTime = 0;\n  this.canJump = true;\n  this.jumping = false;\n}\n\nPlayer.prototype.checkInput = function () {\n  const drag = this.scape().speed;\n  const max = this.maxSpeed;\n  const delta = (this.grounded ? .8 : .4);\n  // allow higher/lower max when on slant!\n\n  if(Listener.pressed(37)) {\n    this.speed -= delta;\n    if(this.speed < drag - max) this.speed = drag - max;\n  } else if(Listener.pressed(39)){\n    this.speed += delta;\n    if(this.speed > max) this.speed = max;\n  } else {\n    if(true){}\n  }\n\n  // may want a jump toggle on key release\n  if(Listener.pressed(38)){\n    if(this.canJump){\n      this.jump();\n    }\n  } else {\n    this.jumping = false;\n    if(this.grounded) this.canJump = true;\n  }\n};\n\nPlayer.prototype.scape = function () {\n  return this.scapes[this.state];\n};\n\nPlayer.prototype.jump = function () {\n  this.grounded = false;\n  this.fallSpeed = -8 - .5 * (this.scape().speed - this.speed) * this.massSlope(); // + this.speed * mass.slope\n  this.jumping = true;\n  this.canJump = false;\n};\n\nPlayer.prototype.turn = function () {\n  this.angle += 0.05 * (this.speed - this.scape().speed);\n};\n\nPlayer.prototype.move = function () {\n  this.checkInput();\n  this.turn();\n  const drag = this.scape().speed;\n\n  if(this.grounded){\n    if(this.speed > drag){\n      this.speed -= .15;\n      if(this.speed < drag) this.speed = drag;\n    } else if (this.speed < drag){\n      this.speed += .15;\n      if(this.speed > drag) this.speed = drag;\n    }\n    this.speed += this.massSlope();\n  }\n  const massY = this.massY();\n  console.log(this.massSlope());\n  if(!this.grounded){\n    this.canJump = false;\n    this.fall(massY);\n  } else {\n\n    // need to track current mass?\n    // see if we fell off of it?\n    if(massY === 0 || massY > this.y + 5){\n      this.grounded = false;\n    } else {\n      this.y = massY;\n    }\n  }\n\n  this.x += this.speed;\n\n  // const scape()Data = this.waveData();\n  // if(!this.grounded){\n  //   this.fall(waveData);\n  // }\n};\n\nPlayer.prototype.fall = function (massY) {\n  const delta = (this.jumping ? .02 : .05)\n  this.fallTime += delta;\n  this.fallSpeed += this.fallTime;\n  this.y += this.fallSpeed;\n\n  const dif = massY - this.y\n  if(dif < 0 && Math.abs(dif) < this.fallSpeed * 2){\n    this.y = massY;\n    this.grounded = true;\n    this.fallSpeed = 0;\n    this.fallTime = 0;\n  }\n};\n\nPlayer.prototype.mass = function () {\n  let closestMass = null;\n  this.scape().masses.forEach( mass => {\n    if(mass.left.x < this.x && mass.right.x > this.x){\n      const y = mass.y(this.x);\n\n      // TODO: turn the \"5\" into a sensible number\n      //       prevents slipping through when mass shifts y\n      if(y + 10 >= this.y && (!closestMass || y < closestMass.y(this.x))){\n        closestMass = mass;\n      }\n    }\n  });\n  return closestMass;\n};\n\nPlayer.prototype.massY = function () {\n  const mass = this.mass();\n  return (mass ? mass.y(this.x) : 0);\n};\n\nPlayer.prototype.massSlope = function () {\n  const mass = this.mass();\n  return (mass ? mass.slope() : 0);\n};\n\nPlayer.prototype.render = function (ctx) {\n  const speedRatio = Math.abs(this.speed) / this.maxSpeed;\n  const grow = (1 + speedRatio * .15);\n  const shrink = (1 - speedRatio * .15);\n\n  ctx.fillStyle = Color.player();\n  ctx.beginPath();\n  ctx.ellipse(\n    this.x,\n    this.y - this.radius * shrink,\n    this.radius * grow,\n    this.radius * shrink,\n    0, 0 + this.angle,\n    Math.PI + this.angle);\n  ctx.fill();\n\n  ctx.beginPath();\n  ctx.fillStyle = \"white\";\n  ctx.ellipse(\n    this.x,\n    this.y - this.radius * shrink,\n    this.radius * grow,\n    this.radius * shrink,\n    0, Math.PI + this.angle,\n    Math.PI * 2 + this.angle);\n  ctx.fill();\n};\n\n\nmodule.exports = Player;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/player.js\n ** module id = 2\n ** module chunks = 0\n **/","function Color(){\n  this.lIncreasing = true;\n\n  this.h = Math.random() * 360;\n  this.s = 100;\n  this.l = 40;\n}\n\nColor.prototype.step = function(){\n  this.h >= 360 ? this.h = 0 : this.h += .5;\n\n  // if(this.lIncreasing){\n  //   if(this.l >= 10){\n  //     this.lIncreasing = false;\n  //     this.l -= .05;\n  //   } else this.l += .05;\n  // } else {\n  //   if(this.l <= 0){\n  //     this.lIncreasing = true;\n  //     this.l += .05;\n  //   } else this.l -= .05;\n  // }\n\n  // lightness could depend on how well we're doing\n};\n\nColor.prototype.main = function () {\n  const hsla = `hsla(${this.h}, ${this.s}%, ${0}%, 1)`;\n  return hsla;\n};\n\nColor.prototype.mass = function (dif) {\n  const hsla = `hsla(${this.h + 135 + dif}, ${this.s}%, ${this.l}%, 1)`;\n  return hsla;\n};\n\nColor.prototype.player = function () {\n  const hsla = `hsla(${this.h}, ${this.s}%, ${this.l}%, 1)`;\n  return hsla;\n};\n\nmodule.exports = new Color;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/color.js\n ** module id = 3\n ** module chunks = 0\n **/","const _viableKeys = [37, 38, 39, 40];\n\nfunction Listener(){\n  this.keys = {};\n\n  document.addEventListener(\"keydown\", e => this._keyDown(e));\n  document.addEventListener(\"keyup\", e => this._keyUp(e));\n}\n\nListener.prototype._keyDown = function (e) {\n  const code = e.keyCode;\n  if(_viableKeys.includes(code)){\n    e.preventDefault();\n    this.keys[e.keyCode] = true;\n  }\n};\n\nListener.prototype._keyUp = function (e) {\n  const code = e.keyCode;\n  if(_viableKeys.includes(code)){\n    e.preventDefault();\n    delete this.keys[code];\n  }\n};\n\nListener.prototype.pressed = function (key) {\n  return this.keys[key];\n};\n\nmodule.exports = new Listener;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/listener.js\n ** module id = 4\n ** module chunks = 0\n **/","const Color = require('./color');\n\nfunction Canvas(){\n  this.self = document.getElementById(\"canvas\")\n\n  this.self.width = window.innerWidth;\n  this.self.height = window.innerHeight;\n\n  this.width = this.self.width;\n  this.height = this.self.height;\n  this.ctx = this.self.getContext(\"2d\");\n\n\n  this.ctx.globalAlpha = 0.7;\n}\n\nCanvas.prototype.render = function () {\n  this.self.style.background = Color.main();\n  this.ctx.clearRect(0, 0, this.width, this.height);\n};\n\n\nmodule.exports = Canvas;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/canvas.js\n ** module id = 5\n ** module chunks = 0\n **/","const Mass = require('./mass');\nconst Color = require('./color');\n\nfunction Scape(canvas, level) {\n  this.dif = level * 60;\n  this.canvas = canvas;\n  this.spacing = 200; // 250 ish?\n  this.speed = -4 - .5 * level; // -3 is good with slow music!\n  this.masses = Mass.generateMasses(\n    canvas.width,\n    canvas.height,\n    level,\n    this.spacing\n  );\n}\n\nScape.prototype.move = function () {\n  this.masses.forEach( mass => {\n    mass.move(this.speed);\n  });\n  this.keepMassesInBounds();\n};\n\nScape.prototype.render = function() {\n  const ctx = this.canvas.ctx;\n  ctx.save();\n  ctx.fillStyle = Color.mass(this.dif);\n\n  this.masses.forEach( mass => {\n    mass.render(ctx);\n  });\n\n  ctx.restore();\n};\n\nScape.prototype.keepMassesInBounds = function(){\n  const masses = this.masses;\n  const spacing = this.spacing;\n\n  if(masses[0].bottom.x < (0 - spacing * 2)){\n    let randomOffset = Math.random() * 150;\n    const mass = new Mass(\n      masses[masses.length-1].bottom.x + spacing + (Math.random() * 120 - 60),\n      this.canvas.height / 2 + randomOffset\n    );\n    masses.push(mass);\n    masses.shift();\n  }\n};\n\nmodule.exports = Scape;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/scape.js\n ** module id = 6\n ** module chunks = 0\n **/","const Color = require('./color');\nconst Point = require('./point');\n\nfunction Mass(x, y){\n  const x1 = x + (Math.random() * 50 + 150);\n  const y1 = y + Math.random() * 180;\n  const x2 = x - (Math.random() * 50 + 150);\n  const y2 = y + Math.random() * 180;\n  const x3 = x;\n  const y3 = y + Math.random() * 100 + 200;\n  const speed = 0.0175 + Math.random()*0.0275;\n\n  this.right = new Point(x1, y1, speed);\n  this.left = new Point(x2, y2, speed);\n  this.bottom = new Point(x3, y3, speed, true);\n}\n\nMass.prototype.render = function (ctx) {\n  ctx.beginPath();\n  ctx.moveTo(this.right.x, this.right.y);\n  ctx.lineTo(this.left.x, this.left.y);\n  ctx.lineTo(this.bottom.x, this.bottom.y);\n  ctx.fill();\n};\n\nMass.prototype.move = function (speed) {\n  this.right.move(speed);\n  this.left.move(speed);\n  this.bottom.move(speed);\n};\n\nMass.generateMasses = function(width, height, level, spacing){\n  const yCenter = height / 2;\n  const masses = [];\n\n  for (let x = -(spacing * 2 + level * spacing / 3); x <= width + spacing * 2; x += spacing) {\n    let randomOffset = Math.random() * 150;\n    const mass = new Mass(\n      x + (Math.random() * 120 - 60),\n      yCenter + randomOffset\n    );\n    masses.push(mass);\n  }\n  return masses;\n};\n\nMass.prototype.y = function (playerX) {\n  const total = Math.abs(this.right.x - this.left.x)\n  const left = Math.abs(playerX - this.left.x);\n  const right = Math.abs(playerX - this.right.x);\n\n  const leftWeight = right / total; // opposite on purpose\n  const rightWeight = left / total; // closer should mean bigger, not smaller\n\n  return (this.left.y * leftWeight + this.right.y * rightWeight);\n};\n\nMass.prototype.slope = function () {\n  return (this.left.y - this.right.y) / (this.left.x - this.right.x);\n};\n\nmodule.exports = Mass;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/mass.js\n ** module id = 7\n ** module chunks = 0\n **/","function Point(x, y, speed, pendulum){\n  this.x = x;\n  this.y = y;\n  this.oldY = y;\n  this.oldX = x;\n\n  this.pendulum = pendulum || false;\n  this.angle = Math.random() * 60;\n  this.speed = speed;\n  this.amplitude = Math.random() * 30;\n}\n\nPoint.prototype.swing = function () {\n  this.x = this.oldX + Math.sin(this.angle) * this.amplitude / 2;\n};\n\nPoint.prototype.move = function (speed) {\n  this.y = this.oldY + Math.sin(this.angle) * this.amplitude;\n  if(this.pendulum) this.swing();\n  this.x += speed;\n  this.oldX += speed;\n  this.angle += this.speed;\n};\n\nmodule.exports = Point;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/point.js\n ** module id = 8\n ** module chunks = 0\n **/"],"sourceRoot":""}